<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>AI Fitness Tracker | Neural-Link</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Seguimiento fitness inteligente con IA local">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>

<body>

<canvas id="matrixCanvas"></canvas>

<header>
  <h1>AI Fitness Tracker</h1>
  <p>âŸ¦ BIO-ESCÃNER ACTIVO | VISIÃ“N IA ACTIVADA âŸ§</p>
  <div id="clock">--:--:--</div>
  <div id="clockJoke"></div>
  <button id="smileBtn" class="icon-btn" aria-label="SonreÃ­r">ğŸ˜Š</button>
</header>

<nav class="tabs" role="tablist">
  <button class="tab active" data-target="dashboard">Dashboard</button>
  <button class="tab" data-target="body">Cuerpo</button>
  <button class="tab" data-target="meals">Comidas</button>
  <button class="tab" data-target="vision">VisiÃ³n IA</button>
  <button class="tab" data-target="workout">Entreno</button>
  <button class="tab" data-target="coach">IA Coach</button>
  <button class="tab" data-target="settings">Config</button>
</nav>

<main class="app-grid">

  <!-- DASHBOARD -->
  <section id="dashboard" class="panel active">
    <div class="card">
      <h3>ğŸ”¥ CalorÃ­as Hoy</h3>
      <p id="totalCalories">0 kcal</p>
      <div class="progress"><div id="calProgress"></div></div>
      <p id="calStatus">Meta: 0 kcal</p>
    </div>

    <div class="card">
      <h3>ğŸ’ª ProteÃ­na Hoy</h3>
      <p id="totalProtein">0 g</p>
      <div class="progress"><div id="protProgress"></div></div>
      <p>Meta: <span id="proteinGoalDisplay">150</span>g</p>
    </div>

    <div class="card">
      <h3>ğŸ“Š Resumen Diario</h3>
      <p>Comidas: <span id="mealCount">0</span></p>
      <p>Ejercicios: <span id="exerciseCount">0</span></p>
      <p>Ãšltima actualizaciÃ³n: <span id="lastUpdate">--:--</span></p>
    </div>

    <button id="toggleGym" class="toggle-btn" aria-pressed="false">ğŸ‹ï¸ Modo GYM</button>
  </section>

  <!-- BODY -->
  <section id="body" class="panel">
    <h2>ğŸ“ˆ BiometrÃ­a</h2>
    <div class="card">
      <input id="bodyWeight" type="number" placeholder="Peso (kg)" step="0.1">
      <input id="bodyFat" type="number" placeholder="Grasa corporal (%)" step="0.1">
      <input id="bodyMuscle" type="number" placeholder="MÃºsculo (kg)" step="0.1">
      <button id="saveBodyBtn">ğŸ’¾ Guardar BiometrÃ­a</button>
    </div>
    
    <div class="card">
      <h3>Historial de Peso</h3>
      <canvas id="weightChart" height="200"></canvas>
    </div>
  </section>

  <!-- MEALS -->
  <section id="meals" class="panel">
    <h2>ğŸ½ï¸ Registrar Comida</h2>
    
    <div class="card">
      <h3>Modo RÃ¡pido (Texto)</h3>
      <textarea id="aiMealText" placeholder="Describe tu comida: Ej: '200g de arroz integral, 150g de pechuga de pollo a la plancha, ensalada verde...'" rows="3"></textarea>
      <button id="analyzeMealBtn">ğŸ” Analizar con IA</button>
      
      <div class="form-row">
        <input id="mealName" placeholder="Nombre de la comida">
        <input id="mealCalories" type="number" placeholder="CalorÃ­as (kcal)">
        <input id="mealProtein" type="number" placeholder="ProteÃ­na (g)">
        <input id="mealCarbs" type="number" placeholder="Carbohidratos (g)">
        <input id="mealFat" type="number" placeholder="Grasa (g)">
      </div>
      
      <button id="addMealBtn" class="primary">â• AÃ±adir Comida</button>
    </div>

    <div class="card">
      <h3>ğŸ“‹ Comidas de Hoy</h3>
      <ul id="mealList"></ul>
      <p class="hint">Total calorÃ­as hoy: <span id="todayCalories">0</span> kcal</p>
    </div>
  </section>

  <!-- VISION IA (NUEVO) -->
  <section id="vision" class="panel">
    <h2>ğŸ‘ï¸ VisiÃ³n IA - Analizar Alimentos</h2>
    
    <div class="card">
      <h3>ğŸ“¸ Subir Imagen</h3>
      <div class="upload-zone" id="uploadZone">
        <p>Arrastra una imagen aquÃ­ o haz clic para seleccionar</p>
        <p class="hint">Puedes subir fotos de platos, etiquetas nutricionales, o ingredientes</p>
        <input type="file" id="imageInput" accept="image/*" capture="environment" hidden>
        <button id="captureBtn" class="icon-btn">ğŸ“· Usar CÃ¡mara</button>
        <button id="uploadBtn" class="icon-btn">ğŸ“ Seleccionar Archivo</button>
      </div>
      
      <div id="imagePreview" class="image-preview" hidden>
        <img id="previewImage" src="" alt="Vista previa">
        <button id="removeImage" class="delete-btn">Ã—</button>
      </div>
      
      <div class="form-row">
        <select id="foodType">
          <option value="plate">ğŸ½ï¸ Plato completo</option>
          <option value="label">ğŸ·ï¸ Etiqueta nutricional</option>
          <option value="ingredients">ğŸ¥• Ingredientes sueltos</option>
        </select>
        <button id="analyzeImageBtn" disabled>ğŸ”¬ Analizar Imagen con IA</button>
      </div>
    </div>

    <div class="card">
      <h3>ğŸ§  Resultados del AnÃ¡lisis</h3>
      <div id="aiResults">
        <p class="placeholder">Los resultados aparecerÃ¡n aquÃ­ despuÃ©s del anÃ¡lisis...</p>
      </div>
      <div id="nutritionFacts" class="nutrition-card" hidden>
        <h4>ğŸ“Š InformaciÃ³n Nutricional Detectada</h4>
        <table>
          <tr><td>CalorÃ­as:</td><td id="detectedCalories">-</td></tr>
          <tr><td>ProteÃ­nas:</td><td id="detectedProtein">- g</td></tr>
          <tr><td>Carbohidratos:</td><td id="detectedCarbs">- g</td></tr>
          <tr><td>Grasas:</td><td id="detectedFat">- g</td></tr>
          <tr><td>Alimentos detectados:</td><td id="detectedFoods">-</td></tr>
        </table>
        <button id="useDetectionBtn" class="primary">âœ… Usar Estos Valores</button>
      </div>
    </div>

    <div class="card">
      <h3>âš™ï¸ ConfiguraciÃ³n de IA</h3>
      <label for="apiKey">Clave API Gemini:</label>
      <input type="password" id="apiKey" placeholder="Ingresa tu clave API de Google AI Studio">
      <button id="saveApiKey">ğŸ’¾ Guardar Clave</button>
      <p class="hint">ObtÃ©n una clave gratuita en: <a href="https://aistudio.google.com/app/apikey" target="_blank">Google AI Studio</a></p>
    </div>
  </section>

  <!-- WORKOUT -->
  <section id="workout" class="panel">
    <h2>ğŸ’ª Entrenamiento</h2>
    <div class="card">
      <input id="exerciseName" placeholder="Ejercicio (ej: Press banca)">
      <div class="form-row">
        <input id="workoutSets" type="number" placeholder="Series" min="1">
        <input id="workoutReps" type="number" placeholder="Repeticiones" min="1">
        <input id="workoutWeight" type="number" placeholder="Peso (kg)" step="0.5">
      </div>
      <button id="addExerciseBtn">â• Registrar Ejercicio</button>
    </div>
    
    <div class="card">
      <h3>ğŸ“ˆ Ejercicios de Hoy</h3>
      <ul id="exerciseList"></ul>
    </div>
  </section>

  <!-- COACH -->
  <section id="coach" class="panel">
    <h2>ğŸ¤– IA Coach</h2>
    <div class="card">
      <textarea id="aiEmergencyText" placeholder="Describe tu situaciÃ³n: Ej: 'Hoy no pude entrenar porque...' o 'ComÃ­ de mÃ¡s en...'" rows="4"></textarea>
      <button id="compensateBtn">âš¡ CompensaciÃ³n de Emergencia</button>
    </div>
    
    <div class="card">
      <h3>ğŸ“ Respuesta de la IA</h3>
      <div id="aiResponse" class="ai-response"></div>
      <div id="adjustmentPlan" style="display:none;">
        <h4>ğŸ“‹ Plan de Ajuste</h4>
        <p id="planDetails"></p>
      </div>
    </div>
  </section>

  <!-- SETTINGS -->
  <section id="settings" class="panel">
    <h2>âš™ï¸ ConfiguraciÃ³n</h2>
    <div class="card">
      <h3>Metas Diarias</h3>
      <label for="calorieGoalInput">CalorÃ­as objetivo:</label>
      <input id="calorieGoalInput" type="number" value="3200">
      
      <label for="proteinGoalInput">ProteÃ­na objetivo (g):</label>
      <input id="proteinGoalInput" type="number" value="150">
      
      <button id="saveGoalsBtn">ğŸ’¾ Guardar Metas</button>
    </div>
    
    <div class="card">
      <h3>Modo IA</h3>
      <select id="aiMode">
        <option value="suggestions">ğŸ’¡ Solo sugerencias</option>
        <option value="automatic">ğŸ¤– AutomÃ¡tico (recomendado)</option>
        <option value="strict">ğŸ”’ Modo estricto</option>
      </select>
      <button id="saveAiSettings">ğŸ’¾ Guardar Ajustes IA</button>
    </div>
    
    <div class="card">
      <h3>ğŸ’¾ Datos</h3>
      <button id="exportDataBtn">ğŸ“¤ Exportar Datos</button>
      <button id="importDataBtn">ğŸ“¥ Importar Datos</button>
      <button id="clearDataBtn" class="danger">ğŸ—‘ï¸ Borrar Todos los Datos</button>
    </div>
  </section>

</main>

<!-- MODALES -->
<div id="confirmModal" class="modal" aria-hidden="true">
  <div class="modal-content">
    <h3 id="confirmMessage">Â¿EstÃ¡s seguro?</h3>
    <div class="modal-actions">
      <button id="confirmOk" class="primary">SÃ­</button>
      <button id="confirmCancel">Cancelar</button>
    </div>
  </div>
</div>

<div id="smileOverlay" class="overlay" aria-hidden="true"></div>

<div id="toasts"></div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="script.js"></script>
</body>
</html>
